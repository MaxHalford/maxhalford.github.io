<!doctype html><html lang=en><head><script defer src=https://unpkg.com/@tinybirdco/flock.js data-host=https://api.tinybird.co data-token=p.eyJ1IjogImMwMjJhMjg1LWJmY2YtNDc0OC1hYzczLTJhMDQ1Njk3NTI0YyIsICJpZCI6ICIzNjc3NjQ3Ny04MTE2LTRmYWQtYjcwMy1iZmM3YjMwZGJjMjMifQ.A0vHm-VWbXG6uBFZiwuspN_AyfSYNrdZE3IgwgWSt4g></script><meta charset=utf-8><meta name=generator content="Hugo 0.113.0"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Max Halford"><meta property="og:url" content="https://maxhalford.github.io/blog/fuzzy-regex-matching-in-python/"><link rel=canonical href=https://maxhalford.github.io/blog/fuzzy-regex-matching-in-python/><meta property="og:title" content="Fuzzy regex matching in Python"><meta property="og:description" content="Fuzzy string matching in a nutshell Say we&rsquo;re looking for a pattern in a blob of text. If you know the text has no typos, then determining whether it contains a pattern is trivial. In Python you can use the in function. You can also write a regex pattern with the re module from the standard library. But what about if the text contains typos? For instance, this might be the case with user inputs on a website, or with OCR outputs."><meta property="og:type" content="article"><meta property="og:url" content="https://maxhalford.github.io/blog/fuzzy-regex-matching-in-python/"><meta property="og:image" content="https://maxhalford.github.io/img/beach.jpg"><meta property="article:section" content="blog"><meta property="article:published_time" content="2022-04-04T00:00:00+00:00"><meta property="article:modified_time" content="2022-04-04T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://maxhalford.github.io/img/beach.jpg"><meta name=twitter:title content="Fuzzy regex matching in Python"><meta name=twitter:description content="Fuzzy string matching in a nutshell Say we&rsquo;re looking for a pattern in a blob of text. If you know the text has no typos, then determining whether it contains a pattern is trivial. In Python you can use the in function. You can also write a regex pattern with the re module from the standard library. But what about if the text contains typos? For instance, this might be the case with user inputs on a website, or with OCR outputs."><link rel=icon href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>🦔</text></svg>"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/maxhalford.github.io\/"},"articleSection":"blog","name":"Fuzzy regex matching in Python","headline":"Fuzzy regex matching in Python","description":"Fuzzy string matching in a nutshell Say we\u0026rsquo;re looking for a pattern in a blob of text. If you know the text has no typos, then determining whether it contains a pattern is trivial. In Python you can use the in function. You can also write a regex pattern with the re module from the standard library. But what about if the text contains typos? For instance, this might be the case with user inputs on a website, or with OCR outputs.","inLanguage":"en-US","author":"Max Halford","creator":"Max Halford","publisher":"Max Halford","accountablePerson":"Max Halford","copyrightHolder":"Max Halford","copyrightYear":"2022","datePublished":"2022-04-04 00:00:00 \u002b0000 UTC","dateModified":"2022-04-04 00:00:00 \u002b0000 UTC","url":"https:\/\/maxhalford.github.io\/blog\/fuzzy-regex-matching-in-python\/","keywords":["text-processing"]}</script><title>Fuzzy regex matching in Python • Max Halford</title><meta property="og:title" content="Fuzzy regex matching in Python • Max Halford"><meta property="og:type" content="article"><meta name=description content="Fuzzy string matching in a nutshell Say we&rsquo;re looking for a pattern in a blob of text. If you know the text has no typos, then determining whether it contains a pattern is trivial. In Python you can use the in function. You can also write a regex pattern with the re module from the standard library. But what about if the text contains typos? For instance, this might be the case with user inputs on a website, or with OCR outputs."><link rel=stylesheet href=/css/flexboxgrid-6.3.1.min.css><link rel=stylesheet href=/css/github-markdown.min.css><link rel=stylesheet href=/css/highlight/github.css><link rel=stylesheet href=/css/index.css><link rel=preconnect href=https://fonts.gstatic.com><link href="https://fonts.googleapis.com/css2?family=PT+Serif:wght@400;700&family=Permanent+Marker&display=swap" rel=stylesheet><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0,tags:"ams"},options:{skipHtmlTags:["script","noscript","style","textarea","pre"]}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+="has-jax"})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></head><body><article class=post id=article><div class="row center-xs" style=text-align:left><div class="col-xs-12 col-sm-10 col-md-7 col-lg-5"><div class=header><header class=header-parts><div class="signatures site-title"><a href=/>Max Halford 🦔</a></div><div class=header-links><a class=header-link href=/>Blog</a>
<a class=header-link href=/links/>Links</a>
<a class=header-link href=/bio/>Bio</a></div></header></div><header class=post-header><h1 class=post-title>Fuzzy regex matching in Python</h1><div class="row post-desc"><div class="col-xs-12 post-desc-items"><time class=post-date datetime="2022-04-04 00:00:00 UTC">2022-04-04</time>
<span class=posts-line-tag>text-processing</span></div></div></header><div class="post-content markdown-body"><h2 id=toc>Table of contents</h2><nav id=TableOfContents><ul><li><a href=#fuzzy-string-matching-in-a-nutshell>Fuzzy string matching in a nutshell</a></li><li><a href=#the-regex-python-library>The <code>regex</code> Python library</a></li><li><a href=#human-friendly-interface>Human friendly interface</a></li></ul></nav><h2 id=fuzzy-string-matching-in-a-nutshell>Fuzzy string matching in a nutshell</h2><p>Say we&rsquo;re looking for a pattern in a blob of text. If you know the text has no typos, then determining whether it contains a pattern is trivial. In Python you can use the <code>in</code> function. You can also write a regex pattern with the <code>re</code> module from the standard library. But what about if the text contains typos? For instance, this might be the case with user inputs on a website, or with OCR outputs. This is a much harder problem.</p><p><a href=https://www.wikiwand.com/en/Approximate_string_matching>Fuzzy string matching</a> is a cool technique to find patterns in noisy text. In Python there used to be a ubiquitous library called <a href=https://github.com/seatgeek/fuzzywuzzy><code>fuzzywuzzy</code></a>. It got renamed to <a href=https://github.com/seatgeek/thefuzz/blob/master/thefuzz><code>thefuzz</code></a>. Then <a href=https://github.com/maxbachmann/RapidFuzz><code>RapidFuzz</code></a> became the latest kid on the block. Here&rsquo;s an example using the latter:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=kn>from</span> <span class=nn>rapidfuzz</span> <span class=kn>import</span> <span class=n>fuzz</span>
</span></span><span class=line><span class=cl><span class=n>fuzz</span><span class=o>.</span><span class=n>ratio</span><span class=p>(</span><span class=s2>&#34;I had a sandwich&#34;</span><span class=p>,</span> <span class=s2>&#34;I had a sand witch&#34;</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=mf>96.2962962962963</span>
</span></span></code></pre></div><p>These libraries are often used to determine string similarity. This can be very useful for higher level tasks, such as record linkage, which I wrote about in <a href=/blog/transitive-duplicates/>a previous post</a>. For instance, fuzzy string matching is the cornerstone of the <a href=https://github.com/moj-analytical-services/splink>Splink</a> project from the British Ministry of Justice. Also, I fondly remember doing fuzzy string matching at HelloFresh to find duplicate accounts by comparing postal addresses, names, email addresses, etc.</p><p>But fuzzy string matching isn&rsquo;t just about measuring similarities between strings. It also allows locating a pattern in a blob of noisy text. Sadly, popular fuzzy matching libraries don&rsquo;t seem to focus on this aspect. They only allow to measure string similarities.</p><p>I&rsquo;ve <a href=/blog/ocr-spelling-correction-is-hard/>been doing</a> a bunch of OCR postprocessing in the past year. For this task, it&rsquo;s very useful to be able to do fuzzy string matching. Indeed, I have this idea of a supervised system for extracting entities &ndash; such as dates and currency amounts &ndash; from noisy OCR outputs. But for that I have to actually locate search patterns in noisy text, and not just calculate their similarity scores against a bunch of text.</p><h2 id=the-regex-python-library>The <code>regex</code> Python library</h2><p>I got lucky and stumbled over <a href=https://github.com/mrabarnett/mrab-regex>an excellent Python library daringly called <code>regex</code></a>. It has a lot of quality of life features that haven&rsquo;t made it into Python standard library. It truly is a goldmine. Personally, I often find myself using <a href=https://github.com/mrabarnett/mrab-regex#added-capturesdict-hg-issue-86><code>capturesdict</code></a>.</p><p>In particular, the <code>regex</code> library <a href=https://github.com/mrabarnett/mrab-regex#approximate-fuzzy-matching-hg-issue-12-hg-issue-41-hg-issue-109>offers support</a> for fuzzy regex matching. For instance, if you write a date pattern, then fuzzy regex matching allows you to look for matches that allow for mistakes. In other words, the pattern doesn&rsquo;t have to exactly match with the text.</p><p>Let&rsquo;s do an example. Say we have a named regex pattern that looks for dates:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=n>pattern</span> <span class=o>=</span> <span class=sa>r</span><span class=s1>&#39;(?P&lt;YYYY&gt;20\d</span><span class=si>{2}</span><span class=s1>)-(?P&lt;MM&gt;\d{1,2})-(?P&lt;DD&gt;\d{1,2})&#39;</span>
</span></span></code></pre></div><p>Here&rsquo;s a search example with an exact match using Python&rsquo;s <code>re</code> module:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>text</span> <span class=o>=</span> <span class=s1>&#39;I went to the doctor on 2022-03-16.&#39;</span>
</span></span><span class=line><span class=cl><span class=k>match</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=n>pattern</span><span class=p>,</span> <span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>match</span><span class=o>.</span><span class=n>groupdict</span><span class=p>()</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=p>{</span><span class=s1>&#39;YYYY&#39;</span><span class=p>:</span> <span class=s1>&#39;2022&#39;</span><span class=p>,</span> <span class=s1>&#39;MM&#39;</span><span class=p>:</span> <span class=s1>&#39;03&#39;</span><span class=p>,</span> <span class=s1>&#39;DD&#39;</span><span class=p>:</span> <span class=s1>&#39;16&#39;</span><span class=p>}</span>
</span></span></code></pre></div><p>This won&rsquo;t work if the date contains a typo. Meanwhile, the <code>regex</code> library allows augmenting the search pattern by allowing for a maximum number of mistakes. For instance, let&rsquo;s allow for three mistakes.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=kn>import</span> <span class=nn>regex</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>fuzzy_pattern</span> <span class=o>=</span> <span class=sa>f</span><span class=s1>&#39;(</span><span class=si>{</span><span class=n>pattern</span><span class=si>}</span><span class=s1>)</span><span class=se>{{</span><span class=s1>e&lt;=3</span><span class=se>}}</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>text</span> <span class=o>=</span> <span class=s1>&#39;I went to the doctor on 7022-O3-I6.&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>match</span> <span class=o>=</span> <span class=n>regex</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=n>fuzzy_pattern</span><span class=p>,</span> <span class=n>text</span><span class=p>,</span> <span class=n>regex</span><span class=o>.</span><span class=n>BESTMATCH</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>match</span><span class=o>.</span><span class=n>groupdict</span><span class=p>()</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=p>{</span><span class=s1>&#39;YYYY&#39;</span><span class=p>:</span> <span class=s1>&#39;7022&#39;</span><span class=p>,</span> <span class=s1>&#39;MM&#39;</span><span class=p>:</span> <span class=s1>&#39;O3&#39;</span><span class=p>,</span> <span class=s1>&#39;DD&#39;</span><span class=p>:</span> <span class=s1>&#39;I6&#39;</span><span class=p>}</span>
</span></span></code></pre></div><p>It works! I found that not using the <code>regex.BESTMATCH</code> flag produces unintuitive results, so I always have it on.</p><p>The <code>regex</code> library also tells you how many mistakes there were:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=k>match</span><span class=o>.</span><span class=n>fuzzy_counts</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span></code></pre></div><p>The format of <code>fuzzy_counts</code> is <code>(n_substitutions, n_insertions, n_deletes)</code>. Note that transpositions are not supported, which is too bad.</p><p>The <code>fuzzy_changes</code> attributes tell you where the mistakes occurred:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=k>match</span><span class=o>.</span><span class=n>fuzzy_changes</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=p>([</span><span class=mi>24</span><span class=p>,</span> <span class=mi>29</span><span class=p>,</span> <span class=mi>32</span><span class=p>],</span> <span class=p>[],</span> <span class=p>[])</span>
</span></span></code></pre></div><p>These locations are relative to the text that was searched.</p><h2 id=human-friendly-interface>Human friendly interface</h2><p>That&rsquo;s all and well, but I find this interface too raw to work with. I would like some kind of representation which tells me which characters got deleted, inserted, and substituted. I know I can deduce this from the <code>fuzzy_changes</code> attribute, but there&rsquo;s still some lifting to do. In particular, it gets a bit tricky when you have to handle deletions and insertions, which mess with the indexing. I&rsquo;ll spare you the details.</p><p>As I mentioned at the end of <a href=/blog/ocr-spelling-correction-is-hard/>my last post</a>, I&rsquo;m working on a piece of software for doing OCR post-processing. It&rsquo;s called <a href=https://github.com/MaxHalford/orc>orc</a>. As of now, I have only scratched the surface of what I want to do. However, I did implement a friendlier interface to fuzzy regex matching. Here&rsquo;s an example:</p><details><summary>🐍 <code>orc.py</code> 👹</summary><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=kn>from</span> <span class=nn>__future__</span> <span class=kn>import</span> <span class=n>annotations</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>abc</span> <span class=kn>import</span> <span class=n>ABC</span><span class=p>,</span> <span class=n>abstractmethod</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>dataclasses</span> <span class=kn>import</span> <span class=n>dataclass</span><span class=p>,</span> <span class=n>field</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>regex</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Edit</span><span class=p>(</span><span class=n>ABC</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nd>@abstractmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>do</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>s</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=o>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@dataclass</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Substitution</span><span class=p>(</span><span class=n>Edit</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>at</span><span class=p>:</span> <span class=nb>int</span>
</span></span><span class=line><span class=cl>    <span class=n>old</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>new</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>do</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>s</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>s</span><span class=p>[:</span> <span class=bp>self</span><span class=o>.</span><span class=n>at</span><span class=p>]</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>new</span> <span class=o>+</span> <span class=n>s</span><span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>at</span> <span class=o>+</span> <span class=mi>1</span> <span class=p>:]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@dataclass</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Insertion</span><span class=p>(</span><span class=n>Edit</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>at</span><span class=p>:</span> <span class=nb>int</span>
</span></span><span class=line><span class=cl>    <span class=n>new</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>do</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>s</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>s</span><span class=p>[:</span> <span class=bp>self</span><span class=o>.</span><span class=n>at</span><span class=p>]</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>new</span> <span class=o>+</span> <span class=n>s</span><span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>at</span> <span class=p>:]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@dataclass</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Deletion</span><span class=p>(</span><span class=n>Edit</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>old</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>at</span><span class=p>:</span> <span class=nb>int</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>do</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>s</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>s</span><span class=p>[:</span> <span class=bp>self</span><span class=o>.</span><span class=n>at</span><span class=p>]</span> <span class=o>+</span> <span class=n>s</span><span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>at</span> <span class=o>+</span> <span class=mi>1</span> <span class=p>:]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@dataclass</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Edits</span><span class=p>(</span><span class=n>Edit</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>substitutions</span><span class=p>:</span> <span class=nb>list</span><span class=p>[</span><span class=n>Substitution</span><span class=p>]</span> <span class=o>=</span> <span class=n>field</span><span class=p>(</span><span class=n>default_factory</span><span class=o>=</span><span class=nb>list</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>insertions</span><span class=p>:</span> <span class=nb>list</span><span class=p>[</span><span class=n>Insertion</span><span class=p>]</span> <span class=o>=</span> <span class=n>field</span><span class=p>(</span><span class=n>default_factory</span><span class=o>=</span><span class=nb>list</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>deletions</span><span class=p>:</span> <span class=nb>list</span><span class=p>[</span><span class=n>Deletion</span><span class=p>]</span> <span class=o>=</span> <span class=n>field</span><span class=p>(</span><span class=n>default_factory</span><span class=o>=</span><span class=nb>list</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>__post_init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>insertions</span> <span class=o>=</span> <span class=nb>sorted</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>insertions</span><span class=p>,</span> <span class=n>key</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=o>.</span><span class=n>at</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>deletions</span> <span class=o>=</span> <span class=nb>sorted</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>deletions</span><span class=p>,</span> <span class=n>key</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=o>.</span><span class=n>at</span><span class=p>,</span> <span class=n>reverse</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@property</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__len__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>substitutions</span><span class=p>)</span> <span class=o>+</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>insertions</span><span class=p>)</span> <span class=o>+</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>deletions</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__iter__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>yield from</span> <span class=bp>self</span><span class=o>.</span><span class=n>substitutions</span>
</span></span><span class=line><span class=cl>        <span class=k>yield from</span> <span class=bp>self</span><span class=o>.</span><span class=n>insertions</span>
</span></span><span class=line><span class=cl>        <span class=k>yield from</span> <span class=bp>self</span><span class=o>.</span><span class=n>deletions</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>do</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>s</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>edit</span> <span class=ow>in</span> <span class=bp>self</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>s</span> <span class=o>=</span> <span class=n>edit</span><span class=o>.</span><span class=n>do</span><span class=p>(</span><span class=n>s</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>s</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__neg__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>Edits</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>substitutions</span><span class=o>=</span><span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=n>Substitution</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                    <span class=n>at</span><span class=o>=</span><span class=n>s</span><span class=o>.</span><span class=n>at</span>
</span></span><span class=line><span class=cl>                    <span class=o>+</span> <span class=nb>sum</span><span class=p>(</span><span class=mi>1</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>insertions</span> <span class=k>if</span> <span class=n>i</span><span class=o>.</span><span class=n>at</span> <span class=o>&lt;</span> <span class=n>s</span><span class=o>.</span><span class=n>at</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=o>-</span> <span class=nb>sum</span><span class=p>(</span><span class=mi>1</span> <span class=k>for</span> <span class=n>d</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>deletions</span> <span class=k>if</span> <span class=n>d</span><span class=o>.</span><span class=n>at</span> <span class=o>&lt;</span> <span class=n>s</span><span class=o>.</span><span class=n>at</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                    <span class=n>old</span><span class=o>=</span><span class=n>s</span><span class=o>.</span><span class=n>new</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>new</span><span class=o>=</span><span class=n>s</span><span class=o>.</span><span class=n>old</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>for</span> <span class=n>s</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>substitutions</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>insertions</span><span class=o>=</span><span class=p>[</span><span class=n>Insertion</span><span class=p>(</span><span class=n>at</span><span class=o>=</span><span class=n>d</span><span class=o>.</span><span class=n>at</span><span class=p>,</span> <span class=n>new</span><span class=o>=</span><span class=n>d</span><span class=o>.</span><span class=n>old</span><span class=p>)</span> <span class=k>for</span> <span class=n>d</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>deletions</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>deletions</span><span class=o>=</span><span class=p>[</span><span class=n>Deletion</span><span class=p>(</span><span class=n>at</span><span class=o>=</span><span class=n>i</span><span class=o>.</span><span class=n>at</span><span class=p>,</span> <span class=n>old</span><span class=o>=</span><span class=n>i</span><span class=o>.</span><span class=n>new</span><span class=p>)</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>insertions</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@classmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>from_regex</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=k>match</span><span class=p>:</span> <span class=n>regex</span><span class=o>.</span><span class=n>Match</span><span class=p>,</span> <span class=n>specimen</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>cls</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>substitutions</span><span class=o>=</span><span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=n>Substitution</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                    <span class=n>at</span><span class=o>=</span><span class=n>at</span> <span class=o>-</span> <span class=k>match</span><span class=o>.</span><span class=n>start</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>                    <span class=n>old</span><span class=o>=</span><span class=k>match</span><span class=o>.</span><span class=n>group</span><span class=p>()[</span><span class=n>at</span> <span class=o>-</span> <span class=k>match</span><span class=o>.</span><span class=n>start</span><span class=p>()],</span>
</span></span><span class=line><span class=cl>                    <span class=n>new</span><span class=o>=</span><span class=n>specimen</span><span class=p>[</span>
</span></span><span class=line><span class=cl>                        <span class=n>at</span>
</span></span><span class=line><span class=cl>                        <span class=o>-</span> <span class=k>match</span><span class=o>.</span><span class=n>start</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                        <span class=o>-</span> <span class=nb>sum</span><span class=p>(</span><span class=mi>1</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=k>match</span><span class=o>.</span><span class=n>fuzzy_changes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=k>if</span> <span class=n>x</span> <span class=o>&lt;</span> <span class=n>at</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                        <span class=o>+</span> <span class=nb>sum</span><span class=p>(</span><span class=mi>1</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=k>match</span><span class=o>.</span><span class=n>fuzzy_changes</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=k>if</span> <span class=n>x</span> <span class=o>&lt;</span> <span class=n>at</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>for</span> <span class=n>at</span> <span class=ow>in</span> <span class=k>match</span><span class=o>.</span><span class=n>fuzzy_changes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>insertions</span><span class=o>=</span><span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=n>Insertion</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                    <span class=n>at</span><span class=o>=</span><span class=n>at</span> <span class=o>-</span> <span class=k>match</span><span class=o>.</span><span class=n>start</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>                    <span class=n>new</span><span class=o>=</span><span class=n>specimen</span><span class=p>[</span>
</span></span><span class=line><span class=cl>                        <span class=n>at</span>
</span></span><span class=line><span class=cl>                        <span class=o>-</span> <span class=k>match</span><span class=o>.</span><span class=n>start</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                        <span class=o>-</span> <span class=nb>sum</span><span class=p>(</span><span class=mi>1</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=k>match</span><span class=o>.</span><span class=n>fuzzy_changes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=k>if</span> <span class=n>x</span> <span class=o>&lt;</span> <span class=n>at</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>for</span> <span class=n>at</span> <span class=ow>in</span> <span class=k>match</span><span class=o>.</span><span class=n>fuzzy_changes</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>deletions</span><span class=o>=</span><span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=n>Deletion</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                    <span class=n>at</span><span class=o>=</span><span class=n>at</span>
</span></span><span class=line><span class=cl>                    <span class=o>-</span> <span class=k>match</span><span class=o>.</span><span class=n>start</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                    <span class=o>+</span> <span class=nb>sum</span><span class=p>(</span><span class=mi>1</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=k>match</span><span class=o>.</span><span class=n>fuzzy_changes</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=k>if</span> <span class=n>x</span> <span class=o>&lt;</span> <span class=n>at</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                    <span class=n>old</span><span class=o>=</span><span class=k>match</span><span class=o>.</span><span class=n>group</span><span class=p>()[</span><span class=n>at</span> <span class=o>-</span> <span class=k>match</span><span class=o>.</span><span class=n>start</span><span class=p>()],</span>
</span></span><span class=line><span class=cl>                <span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>for</span> <span class=n>at</span> <span class=ow>in</span> <span class=k>match</span><span class=o>.</span><span class=n>fuzzy_changes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@dataclass</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>NearMatch</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>specimen</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>candidate</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>edits</span><span class=p>:</span> <span class=n>Edits</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@classmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>from_regex</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=k>match</span><span class=p>:</span> <span class=n>regex</span><span class=o>.</span><span class=n>Match</span><span class=p>,</span> <span class=n>specimen</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>cls</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>specimen</span><span class=o>=</span><span class=n>specimen</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>candidate</span><span class=o>=</span><span class=k>match</span><span class=o>.</span><span class=n>group</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=n>edits</span><span class=o>=</span><span class=n>Edits</span><span class=o>.</span><span class=n>from_regex</span><span class=p>(</span><span class=k>match</span><span class=p>,</span> <span class=n>specimen</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__repr__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>candidate</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>candidate</span>
</span></span><span class=line><span class=cl>        <span class=n>s</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>candidate</span><span class=si>}</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>edit</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>edits</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>s</span> <span class=o>+=</span> <span class=s2>&#34; &#34;</span> <span class=o>*</span> <span class=n>edit</span><span class=o>.</span><span class=n>at</span> <span class=o>+</span> <span class=n>edit</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>            <span class=n>candidate</span> <span class=o>=</span> <span class=n>edit</span><span class=o>.</span><span class=n>do</span><span class=p>(</span><span class=n>candidate</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>s</span> <span class=o>+=</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>candidate</span><span class=si>}</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>s</span><span class=o>.</span><span class=n>rstrip</span><span class=p>()</span>
</span></span></code></pre></div></details><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=kn>import</span> <span class=nn>orc</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>regex</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>text</span> <span class=o>=</span> <span class=s1>&#39;I went to see Dr. House. The date was 2021-2-04. It cost 60 euros.&#39;</span>
</span></span><span class=line><span class=cl><span class=n>specimen</span> <span class=o>=</span> <span class=s1>&#39;2020-02-05&#39;</span>
</span></span><span class=line><span class=cl><span class=n>pattern</span> <span class=o>=</span> <span class=n>specimen</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s1>&#39;-&#39;</span><span class=p>,</span> <span class=sa>r</span><span class=s1>&#39;\-&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>fuzzy_pattern</span> <span class=o>=</span> <span class=sa>f</span><span class=s1>&#39;(</span><span class=si>{</span><span class=n>pattern</span><span class=si>}</span><span class=s1>)&#39;</span> <span class=o>+</span> <span class=s1>&#39;{s&lt;=3,i&lt;=3,d&lt;=3}&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>match</span> <span class=o>=</span> <span class=n>regex</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=n>fuzzy_pattern</span><span class=p>,</span> <span class=n>text</span><span class=p>,</span> <span class=n>regex</span><span class=o>.</span><span class=n>BESTMATCH</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>near_match</span> <span class=o>=</span> <span class=n>orc</span><span class=o>.</span><span class=n>NearMatch</span><span class=o>.</span><span class=n>from_regex</span><span class=p>(</span><span class=k>match</span><span class=p>,</span> <span class=n>specimen</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>near_match</span><span class=p>)</span>
</span></span></code></pre></div><pre tabindex=0><code>2021-2-04
   S
2020-2-04
        S
2020-2-05
     I
2020-02-05
</code></pre><p>The <code>near_match</code> object is built from the fuzzy regex match. It has a pretty <code>__repr__</code> method, which is the output you see above. It stores a straightforward list of edits:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=k>for</span> <span class=n>edit</span> <span class=ow>in</span> <span class=n>near_match</span><span class=o>.</span><span class=n>edits</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>edit</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=n>Substitution</span><span class=p>(</span><span class=n>at</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>new</span><span class=o>=</span><span class=s1>&#39;0&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Substitution</span><span class=p>(</span><span class=n>at</span><span class=o>=</span><span class=mi>8</span><span class=p>,</span> <span class=n>new</span><span class=o>=</span><span class=s1>&#39;5&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Insertion</span><span class=p>(</span><span class=n>at</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>new</span><span class=o>=</span><span class=s1>&#39;0&#39;</span><span class=p>)</span>
</span></span></code></pre></div><p>There&rsquo;s also a <code>.do</code> method which applies the edits to a string:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=n>near_match</span><span class=o>.</span><span class=n>edits</span><span class=o>.</span><span class=n>do</span><span class=p>(</span><span class=k>match</span><span class=o>.</span><span class=n>group</span><span class=p>())</span>
</span></span></code></pre></div><pre tabindex=0><code>2020-02-05
</code></pre><p>I also wrote the logic to invert a bunch of edits. Meaning that you can build edits that go from <code>B</code> to <code>A</code> if you have the edits that allow going from <code>A</code> to <code>B</code>. I did this by overloading Python&rsquo;s <code>__neg__</code> method, which allows doing the following:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=p>(</span><span class=o>-</span><span class=n>near_match</span><span class=o>.</span><span class=n>edits</span><span class=p>)</span><span class=o>.</span><span class=n>do</span><span class=p>(</span><span class=s1>&#39;2020-02-05&#39;</span><span class=p>)</span>
</span></span></code></pre></div><pre tabindex=0><code>2021-2-04
</code></pre><p>I think this API is much more fun to work with. It&rsquo;s going to allow me to do a bunch of things. For instance, once I&rsquo;ve compiled a list of edits for many search patterns, I&rsquo;ll be able to build a confusion matrix which tells me how likely it is for two characters to be confused with each other.</p><p>The orc project is likely to change. But you can always check out the code I used for this blog post in <a href=https://github.com/MaxHalford/orc/commit/5d8ea845ca4825e581c457accdf66d59edfbb1f1>this commit</a>. In particular, you can check out <a href=https://github.com/MaxHalford/orc/blob/5d8ea845ca4825e581c457accdf66d59edfbb1f1/wikipedia.ipynb>this notebook</a> which unit tests the fuzzy matching logic against the <a href=https://en.wikipedia.org/wiki/Wikipedia:Lists_of_common_misspellings>Wikipedia common misspellings dataset</a>.</p></div><script type=text/javascript>var s=document.createElement("script");s.setAttribute("src","https://utteranc.es/client.js"),s.setAttribute("repo","MaxHalford/maxhalford.github.io"),s.setAttribute("issue-term","pathname"),s.setAttribute("crossorigin","anonymous"),s.setAttribute("async",null),s.setAttribute("theme","github-light"),document.body.appendChild(s)</script><div style=display:flex;flex-direction:row;justify-content:center;align-items:center;gap:20px;margin-bottom:30px><div class=do-the-thing><div class=elevator><svg class="sweet-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 100 100" enable-background="new 0 0 100 100" height="100" width="100"><path d="M70 47.5H30c-1.4.0-2.5 1.1-2.5 2.5v40c0 1.4 1.1 2.5 2.5 2.5h40c1.4.0 2.5-1.1 2.5-2.5V50C72.5 48.6 71.4 47.5 70 47.5zm-22.5 40h-5v-25h5v25zm10 0h-5v-25h5v25zm10 0h-5V60c0-1.4-1.1-2.5-2.5-2.5H40c-1.4.0-2.5 1.1-2.5 2.5v27.5h-5v-35h35v35z"/><path d="M50 42.5c1.4.0 2.5-1.1 2.5-2.5V16l5.7 5.7c.5.5 1.1.7 1.8.7s1.3-.2 1.8-.7c1-1 1-2.6.0-3.5l-10-10c-1-1-2.6-1-3.5.0l-10 10c-1 1-1 2.6.0 3.5 1 1 2.6 1 3.5.0l5.7-5.7v24c0 1.4 1.1 2.5 2.5 2.5z"/></svg>Back to the top</div></div><iframe src=https://github.com/sponsors/MaxHalford/button title="Sponsor MaxHalford" height=32 width=114 style=border:0;border-radius:6px></iframe></div><script src=https://cdnjs.cloudflare.com/ajax/libs/elevator.js/1.0.1/elevator.min.js></script>
<script>var elementButton=document.querySelector(".elevator"),elevator=new Elevator({element:elementButton,mainAudio:"/music/elevator.mp3",endAudio:"/music/ding.mp3"})</script><style>.down-arrow{font-size:120px;margin-top:90px;margin-bottom:90px;text-shadow:0 -20px #0c1f31,0 0 #c33329;color:transparent;-webkit-transform:scaleY(.8);-moz-transform:scaleY(.8);transform:scaleY(.8)}.elevator{text-align:center;cursor:pointer;width:140px;margin:auto}.elevator:hover{opacity:.7}.elevator svg{width:40px;height:40px;display:block;margin:auto;margin-bottom:5px}</style><div class=related-content><h3 style=margin-top:10px!important;margin-bottom:10px!important>Related posts</h3><ul style=margin-top:0><li><a href=/blog/ocr-spelling-correction-is-hard/>OCR spelling correction is hard</a></li><li><a href=/blog/sklearn-text-classifier-memory-footprint-reduction/>Reducing the memory footprint of a scikit-learn text classifier</a></li><li><a href=/blog/textract-table-to-pandas/>Converting Amazon Textract tables to pandas DataFrames</a></li></ul></div></div></div></article><script></script></body></html>