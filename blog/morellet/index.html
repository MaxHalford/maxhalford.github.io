<!doctype html><html lang=en><head><script async defer data-website-id=6023252a-3a97-470f-b4ee-5082d242bb9a src=https://umami.pourtan.eu/umami.js></script><meta charset=utf-8><meta name=generator content="Hugo 0.109.0"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Max Halford"><meta property="og:url" content="https://maxhalford.github.io/blog/morellet/"><link rel=canonical href=https://maxhalford.github.io/blog/morellet/><link rel=icon href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ü¶î</text></svg>"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/maxhalford.github.io\/"},"articleSection":"blog","name":"Morellet crosses with JavaScript","headline":"Morellet crosses with JavaScript","description":"The days I\u0026rsquo;m working on a deep learning project. I hate it but I promised myself to give it a real try. My scripts are taking a long time so I decided to do some procedural art while I waited. This time I\u0026rsquo;m going to reproduce the following crosses made by Fran√ßois Morellet. I saw them the last I went to the Mus√©e Pompidou with some friends from university. I don\u0026rsquo;t have any smartphone anymore so one my friends was kind enough to take a few pictures for me, including this one.","inLanguage":"en-US","author":"Max Halford","creator":"Max Halford","publisher":"Max Halford","accountablePerson":"Max Halford","copyrightHolder":"Max Halford","copyrightYear":"2019","datePublished":"2019-02-03 00:00:00 \u002b0000 UTC","dateModified":"2019-02-03 00:00:00 \u002b0000 UTC","url":"https:\/\/maxhalford.github.io\/blog\/morellet\/","keywords":["generative-art"]}</script><title>Morellet crosses with JavaScript ‚Ä¢ Max Halford</title><meta property="og:title" content="Morellet crosses with JavaScript ‚Ä¢ Max Halford"><meta property="og:type" content="article"><meta name=description content="The days I&rsquo;m working on a deep learning project. I hate it but I promised myself to give it a real try. My scripts are taking a long time so I decided to do some procedural art while I waited. This time I&rsquo;m going to reproduce the following crosses made by Fran√ßois Morellet. I saw them the last I went to the Mus√©e Pompidou with some friends from university. I don&rsquo;t have any smartphone anymore so one my friends was kind enough to take a few pictures for me, including this one."><link rel=stylesheet href=/css/flexboxgrid-6.3.1.min.css><link rel=stylesheet href=/css/github-markdown.min.css><link rel=stylesheet href=/css/highlight/github.css><link rel=stylesheet href=/css/index.css><link rel=preconnect href=https://fonts.gstatic.com><link href="https://fonts.googleapis.com/css2?family=PT+Serif:wght@400;700&family=Permanent+Marker&display=swap" rel=stylesheet><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0,tags:"ams"},options:{skipHtmlTags:["script","noscript","style","textarea","pre"]}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+="has-jax"})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></head><body><article class=post id=article><div class="row center-xs" style=text-align:left><div class="col-xs-12 col-sm-10 col-md-7 col-lg-5"><div class=header><header class=header-parts><div class="signatures site-title"><a href=/>Max Halford ü¶î</a></div><div class=header-links><a class=header-link href=/>Blog</a>
<a class=header-link href=/links/>Links</a>
<a class=header-link href=/bio/>Bio</a></div></header></div><header class=post-header><h1 class=post-title>Morellet crosses with JavaScript</h1><div class="row post-desc"><div class="col-xs-12 post-desc-items"><time class=post-date datetime="2019-02-03 00:00:00 UTC">2019-02-03</time>
<span class=posts-line-tag>generative-art</span></div></div></header><div class="post-content markdown-body"><p>The days I&rsquo;m working on a deep learning project. I hate it but I promised myself to give it a real try. My scripts are taking a long time so I decided to do some procedural art while I waited. This time I&rsquo;m going to reproduce the following crosses made by <a href=https://www.wikiwand.com/en/Fran%C3%A7ois_Morellet>Fran√ßois Morellet</a>. I saw them the last I went to the Mus√©e Pompidou with some friends from university. I don&rsquo;t have any smartphone anymore so one my friends was kind enough to take a few pictures for me, including this one. The painting is called <a href=https://www.centrepompidou.fr/cpv/resource/cxx585o/ryjG5EL><em>Violet, bleu, vert, jaune, orange, rouge</em></a>.</p><p><img src=/img/blog/morellet/pompidou.jpg alt=pompidou></p><p>This isn&rsquo;t particularly difficult to reproduce but it is satisfying nonetheless. As per usual I&rsquo;m going to start by defining a <code>Point</code> class.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>class</span> <span class=nx>Point</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>constructor</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span> <span class=nx>y</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>x</span> <span class=o>=</span> <span class=nx>x</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>y</span> <span class=o>=</span> <span class=nx>y</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>My intention is to have some kind of <code>Cross</code> class and then do some sort of <code>for</code> loop. The details of the <code>for</code> loop are the most tricky part, we&rsquo;ll back to them further on. Let&rsquo;s first implement the <code>Cross</code> class. I simply represented a cross as a stitch of 5 squares. My idea is that if I&rsquo;m given the center of the cross then I guess the coordinates of the squares that it is composed of. The first thing to do is thus to define a <code>Square</code> class. We&rsquo;ll give it a <code>draw</code> method to display it on a <code>canvas</code>. The drawing procedure starts at the top-left of the square and makes it way around each corner in a clockwise manner.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>class</span> <span class=nx>Square</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>constructor</span> <span class=p>(</span><span class=nx>origin</span><span class=p>,</span> <span class=nx>length</span><span class=p>,</span> <span class=nx>colour</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>origin</span> <span class=o>=</span> <span class=nx>origin</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>length</span> <span class=o>=</span> <span class=nx>length</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>colour</span> <span class=o>=</span> <span class=nx>colour</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>draw</span> <span class=p>(</span><span class=nx>ctx</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Draw clockwise
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>ctx</span><span class=p>.</span><span class=nx>beginPath</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>ctx</span><span class=p>.</span><span class=nx>moveTo</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>origin</span><span class=p>.</span><span class=nx>x</span><span class=p>,</span> <span class=k>this</span><span class=p>.</span><span class=nx>origin</span><span class=p>.</span><span class=nx>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>ctx</span><span class=p>.</span><span class=nx>lineTo</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>origin</span><span class=p>.</span><span class=nx>x</span> <span class=o>+</span> <span class=k>this</span><span class=p>.</span><span class=nx>length</span><span class=p>,</span> <span class=k>this</span><span class=p>.</span><span class=nx>origin</span><span class=p>.</span><span class=nx>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>ctx</span><span class=p>.</span><span class=nx>lineTo</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>origin</span><span class=p>.</span><span class=nx>x</span> <span class=o>+</span> <span class=k>this</span><span class=p>.</span><span class=nx>length</span><span class=p>,</span> <span class=k>this</span><span class=p>.</span><span class=nx>origin</span><span class=p>.</span><span class=nx>y</span> <span class=o>+</span> <span class=k>this</span><span class=p>.</span><span class=nx>length</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>ctx</span><span class=p>.</span><span class=nx>lineTo</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>origin</span><span class=p>.</span><span class=nx>x</span><span class=p>,</span> <span class=k>this</span><span class=p>.</span><span class=nx>origin</span><span class=p>.</span><span class=nx>y</span> <span class=o>+</span> <span class=k>this</span><span class=p>.</span><span class=nx>length</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>ctx</span><span class=p>.</span><span class=nx>lineTo</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>origin</span><span class=p>.</span><span class=nx>x</span><span class=p>,</span> <span class=k>this</span><span class=p>.</span><span class=nx>origin</span><span class=p>.</span><span class=nx>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1>// We want the border color and the fill color to match
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>ctx</span><span class=p>.</span><span class=nx>strokeStyle</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>colour</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>ctx</span><span class=p>.</span><span class=nx>fillStyle</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>colour</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Color the border and the body
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>ctx</span><span class=p>.</span><span class=nx>stroke</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=nx>ctx</span><span class=p>.</span><span class=nx>fill</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=nx>ctx</span><span class=p>.</span><span class=nx>closePath</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>As an example let&rsquo;s draw such a square. We haven&rsquo;t initialized a <code>canvas</code> context yet so let&rsquo;s do just that.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>var</span> <span class=nx>canvas</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;doodle&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>ctx</span> <span class=o>=</span> <span class=nx>canvas</span><span class=p>.</span><span class=nx>getContext</span><span class=p>(</span><span class=s1>&#39;2d&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>square</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Square</span><span class=p>(</span><span class=k>new</span> <span class=nx>Point</span><span class=p>(</span><span class=mi>300</span><span class=p>,</span> <span class=mi>200</span><span class=p>),</span> <span class=mi>140</span><span class=p>,</span> <span class=s1>&#39;#177b4b&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>square</span><span class=p>.</span><span class=nx>draw</span><span class=p>(</span><span class=nx>ctx</span><span class=p>)</span>
</span></span></code></pre></div><p><img src=/img/blog/morellet/square.png alt=square></p><p>We can now define a <code>Cross</code> class in a rather short amount of lines.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>class</span> <span class=nx>Cross</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>constructor</span> <span class=p>(</span><span class=nx>left</span><span class=p>,</span> <span class=nx>top</span><span class=p>,</span> <span class=nx>right</span><span class=p>,</span> <span class=nx>bottom</span><span class=p>,</span> <span class=nx>center</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>left</span> <span class=o>=</span> <span class=nx>left</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>top</span> <span class=o>=</span> <span class=nx>top</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>right</span> <span class=o>=</span> <span class=nx>right</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>bottom</span> <span class=o>=</span> <span class=nx>bottom</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>center</span> <span class=o>=</span> <span class=nx>center</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>draw</span> <span class=p>(</span><span class=nx>ctx</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>left</span><span class=p>.</span><span class=nx>draw</span><span class=p>(</span><span class=nx>ctx</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>top</span><span class=p>.</span><span class=nx>draw</span><span class=p>(</span><span class=nx>ctx</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>right</span><span class=p>.</span><span class=nx>draw</span><span class=p>(</span><span class=nx>ctx</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>bottom</span><span class=p>.</span><span class=nx>draw</span><span class=p>(</span><span class=nx>ctx</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>center</span><span class=p>.</span><span class=nx>draw</span><span class=p>(</span><span class=nx>ctx</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>The next step is to be able to create a cross given it&rsquo;s center and the side length of each square it is made of. With these two pieces of information we can guess the positions of the squares. This isn&rsquo;t too difficult to work out yourself but a diagram can&rsquo;t hurt.</p><p><img src=/img/blog/morellet/coordinates.png alt=coordinates></p><p>We can write down the logic inside a <code>makeCross</code> function.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>function</span> <span class=nx>makeCross</span><span class=p>(</span><span class=nx>center</span><span class=p>,</span> <span class=nx>squareLength</span><span class=p>,</span> <span class=nx>color</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// For convenience
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kd>var</span> <span class=nx>l</span> <span class=o>=</span> <span class=nx>squareLength</span>
</span></span><span class=line><span class=cl>  <span class=kd>var</span> <span class=nx>x</span> <span class=o>=</span> <span class=nx>center</span><span class=p>.</span><span class=nx>x</span>
</span></span><span class=line><span class=cl>  <span class=kd>var</span> <span class=nx>y</span> <span class=o>=</span> <span class=nx>center</span><span class=p>.</span><span class=nx>y</span>
</span></span><span class=line><span class=cl>  <span class=c1>// Create the 5 squares
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kd>var</span> <span class=nx>left</span>   <span class=o>=</span> <span class=k>new</span> <span class=nx>Square</span><span class=p>(</span><span class=k>new</span> <span class=nx>Point</span><span class=p>(</span><span class=nx>x</span> <span class=o>-</span> <span class=mf>1.5</span> <span class=o>*</span> <span class=nx>l</span><span class=p>,</span> <span class=nx>y</span> <span class=o>-</span> <span class=mf>0.5</span> <span class=o>*</span> <span class=nx>l</span><span class=p>),</span> <span class=nx>l</span><span class=p>,</span> <span class=nx>color</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kd>var</span> <span class=nx>top</span>    <span class=o>=</span> <span class=k>new</span> <span class=nx>Square</span><span class=p>(</span><span class=k>new</span> <span class=nx>Point</span><span class=p>(</span><span class=nx>x</span> <span class=o>-</span> <span class=mf>0.5</span> <span class=o>*</span> <span class=nx>l</span><span class=p>,</span> <span class=nx>y</span> <span class=o>-</span> <span class=mf>1.5</span> <span class=o>*</span> <span class=nx>l</span><span class=p>),</span> <span class=nx>l</span><span class=p>,</span> <span class=nx>color</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kd>var</span> <span class=nx>right</span>  <span class=o>=</span> <span class=k>new</span> <span class=nx>Square</span><span class=p>(</span><span class=k>new</span> <span class=nx>Point</span><span class=p>(</span><span class=nx>x</span> <span class=o>+</span> <span class=mf>0.5</span> <span class=o>*</span> <span class=nx>l</span><span class=p>,</span> <span class=nx>y</span> <span class=o>-</span> <span class=mf>0.5</span> <span class=o>*</span> <span class=nx>l</span><span class=p>),</span> <span class=nx>l</span><span class=p>,</span> <span class=nx>color</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kd>var</span> <span class=nx>bottom</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Square</span><span class=p>(</span><span class=k>new</span> <span class=nx>Point</span><span class=p>(</span><span class=nx>x</span> <span class=o>-</span> <span class=mf>0.5</span> <span class=o>*</span> <span class=nx>l</span><span class=p>,</span> <span class=nx>y</span> <span class=o>+</span> <span class=mf>0.5</span> <span class=o>*</span> <span class=nx>l</span><span class=p>),</span> <span class=nx>l</span><span class=p>,</span> <span class=nx>color</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kd>var</span> <span class=nx>center</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Square</span><span class=p>(</span><span class=k>new</span> <span class=nx>Point</span><span class=p>(</span><span class=nx>x</span> <span class=o>-</span> <span class=mf>0.5</span> <span class=o>*</span> <span class=nx>l</span><span class=p>,</span> <span class=nx>y</span> <span class=o>-</span> <span class=mf>0.5</span> <span class=o>*</span> <span class=nx>l</span><span class=p>),</span> <span class=nx>l</span><span class=p>,</span> <span class=nx>color</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=c1>// Assemble the squares and return the resulting cross
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>return</span> <span class=k>new</span> <span class=nx>Cross</span><span class=p>(</span><span class=nx>left</span><span class=p>,</span> <span class=nx>top</span><span class=p>,</span> <span class=nx>right</span><span class=p>,</span> <span class=nx>bottom</span><span class=p>,</span> <span class=nx>center</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Let&rsquo;s create a cross as an example.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>var</span> <span class=nx>cross</span> <span class=o>=</span> <span class=nx>makeCross</span><span class=p>(</span><span class=k>new</span> <span class=nx>Point</span><span class=p>(</span><span class=mi>300</span><span class=p>,</span> <span class=mi>200</span><span class=p>),</span> <span class=mi>140</span><span class=p>,</span> <span class=s1>&#39;#177b4b&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>cross</span><span class=p>.</span><span class=nx>draw</span><span class=p>(</span><span class=nx>ctx</span><span class=p>)</span>
</span></span></code></pre></div><p><img src=/img/blog/morellet/cross.png alt=cross></p><p>I didn&rsquo;t do it on purpose but the cross looks very much like the signs used by French pharmacies&mldr; Now that we can make and draw crosses we should be able to reproduce Morellet&rsquo;s painting. The painting looks very repetitive so there must some patterns we can exploit. If you look at the top left of the original painting you&rsquo;ll see a blue cross. The cross that is to it&rsquo;s direct right is orange. Then the next is blue. And the final one on that &ldquo;row&rdquo; is orange. You can basically look at the painting as a stack of three rows where each row has crosses of different colors separated by two squares. The first row is composed of <font color=#006597>blue</font> and <font color=#ff5c30>orange</font> crosses, the second row has <font color=#ffd652>yellow</font> and <font color=#562b42>purple</font> crosses, whereas the crosses of the third row are <font color=#df2933>red</font> and <font color=#177b4b>green</font>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>function</span> <span class=nx>drawRow</span><span class=p>(</span><span class=nx>start</span><span class=p>,</span> <span class=nx>squareLength</span><span class=p>,</span> <span class=nx>color1</span><span class=p>,</span> <span class=nx>color2</span><span class=p>,</span> <span class=nx>ctx</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>var</span> <span class=nx>x</span> <span class=o>=</span> <span class=nx>start</span><span class=p>.</span><span class=nx>x</span>
</span></span><span class=line><span class=cl>  <span class=kd>var</span> <span class=nx>y</span> <span class=o>=</span> <span class=nx>start</span><span class=p>.</span><span class=nx>y</span>
</span></span><span class=line><span class=cl>  <span class=kd>var</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>  <span class=k>while</span> <span class=p>(</span><span class=kc>true</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>color</span> <span class=o>=</span> <span class=p>[</span><span class=nx>color1</span><span class=p>,</span> <span class=nx>color2</span><span class=p>][</span><span class=nx>i</span> <span class=o>%</span> <span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=nx>makeCross</span><span class=p>(</span><span class=k>new</span> <span class=nx>Point</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span> <span class=nx>y</span><span class=p>),</span> <span class=nx>squareLength</span><span class=p>,</span> <span class=nx>color</span><span class=p>).</span><span class=nx>draw</span><span class=p>(</span><span class=nx>ctx</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>x</span> <span class=o>&gt;</span> <span class=mi>800</span><span class=p>)</span> <span class=p>{</span> <span class=k>break</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>x</span> <span class=o>=</span> <span class=nx>x</span> <span class=o>+</span> <span class=mi>5</span> <span class=o>*</span> <span class=nx>squareLength</span>
</span></span><span class=line><span class=cl>    <span class=nx>i</span> <span class=o>=</span> <span class=nx>i</span> <span class=o>+</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Of course we could have checked that the current <code>x</code> isn&rsquo;t beyond the <code>canvas</code> inside the <code>while</code> condition, but this would have omitted the left squares of the crosses that are partially on the image. Let&rsquo;s try this out by drawing the first three rows.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>var</span> <span class=nx>canvasWidth</span> <span class=o>=</span> <span class=mi>800</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>nSquares</span> <span class=o>=</span> <span class=mi>16</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>length</span> <span class=o>=</span> <span class=nx>canvasWidth</span> <span class=o>/</span> <span class=nx>nSquares</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>blue</span> <span class=o>=</span> <span class=s1>&#39;#006597&#39;</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>orange</span> <span class=o>=</span> <span class=s1>&#39;#ff5c30&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>yellow</span> <span class=o>=</span> <span class=s1>&#39;#ffd652&#39;</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>purple</span> <span class=o>=</span>  <span class=s1>&#39;#562b42&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>red</span> <span class=o>=</span> <span class=s1>&#39;#df2933&#39;</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>green</span> <span class=o>=</span> <span class=s1>&#39;#177b4b&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>drawRow</span><span class=p>(</span><span class=k>new</span> <span class=nx>Point</span><span class=p>(</span><span class=nx>length</span> <span class=o>*</span> <span class=mf>0.5</span><span class=p>,</span> <span class=nx>length</span> <span class=o>*</span> <span class=mf>1.5</span><span class=p>),</span> <span class=nx>length</span><span class=p>,</span> <span class=nx>blue</span><span class=p>,</span> <span class=nx>orange</span><span class=p>,</span> <span class=nx>ctx</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>drawRow</span><span class=p>(</span><span class=k>new</span> <span class=nx>Point</span><span class=p>(</span><span class=nx>length</span> <span class=o>*</span> <span class=mf>2.5</span><span class=p>,</span> <span class=nx>length</span> <span class=o>*</span> <span class=mf>2.5</span><span class=p>),</span> <span class=nx>length</span><span class=p>,</span> <span class=nx>yellow</span><span class=p>,</span> <span class=nx>purple</span><span class=p>,</span> <span class=nx>ctx</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>drawRow</span><span class=p>(</span><span class=k>new</span> <span class=nx>Point</span><span class=p>(</span><span class=nx>length</span> <span class=o>*</span> <span class=mf>4.5</span><span class=p>,</span> <span class=nx>length</span> <span class=o>*</span> <span class=mf>3.5</span><span class=p>),</span> <span class=nx>length</span><span class=p>,</span> <span class=nx>red</span><span class=p>,</span> <span class=nx>green</span><span class=p>,</span> <span class=nx>ctx</span><span class=p>)</span>
</span></span></code></pre></div><p><img src=/img/blog/morellet/first_rows.png alt=first_rows></p><p>If we adjust the size of the squares then the image should change accordingly.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>var</span> <span class=nx>length</span> <span class=o>=</span> <span class=nx>canvasWidth</span> <span class=o>/</span> <span class=nx>nSquares</span> <span class=o>/</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>drawRow</span><span class=p>(</span><span class=k>new</span> <span class=nx>Point</span><span class=p>(</span><span class=nx>length</span> <span class=o>*</span> <span class=mf>0.5</span><span class=p>,</span> <span class=nx>length</span> <span class=o>*</span> <span class=mf>1.5</span><span class=p>),</span> <span class=nx>length</span><span class=p>,</span> <span class=nx>blue</span><span class=p>,</span> <span class=nx>orange</span><span class=p>,</span> <span class=nx>ctx</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>drawRow</span><span class=p>(</span><span class=k>new</span> <span class=nx>Point</span><span class=p>(</span><span class=nx>length</span> <span class=o>*</span> <span class=mf>2.5</span><span class=p>,</span> <span class=nx>length</span> <span class=o>*</span> <span class=mf>2.5</span><span class=p>),</span> <span class=nx>length</span><span class=p>,</span> <span class=nx>yellow</span><span class=p>,</span> <span class=nx>purple</span><span class=p>,</span> <span class=nx>ctx</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>drawRow</span><span class=p>(</span><span class=k>new</span> <span class=nx>Point</span><span class=p>(</span><span class=nx>length</span> <span class=o>*</span> <span class=mf>4.5</span><span class=p>,</span> <span class=nx>length</span> <span class=o>*</span> <span class=mf>3.5</span><span class=p>),</span> <span class=nx>length</span><span class=p>,</span> <span class=nx>red</span><span class=p>,</span> <span class=nx>green</span><span class=p>,</span> <span class=nx>ctx</span><span class=p>)</span>
</span></span></code></pre></div><p><img src=/img/blog/morellet/first_rows_smaller.png alt=first_rows_smaller></p><p>Looking good! All we have to do now is implemented a smart <code>for</code> loop and we should be good. I made a diagram to show where each row starts and the first color of that row. Naturally there are some crosses that start outside of the 16 by 16 grid.</p><p><img src=/img/blog/morellet/grid.png alt=grid></p><p>At first I couldn&rsquo;t manage to think of a <code>for</code> loop that would get the job done. I gave up, watched a movie, went to bed, woke up, had breakfast, and a simple idea came to me. The trick is that nothing is stopping from starting the rows outside of the <code>canvas</code>. Indeed if draw something with, say, negative coordinates then it will simply not get drawn. We can thus simply identify a line that grows beyond the left side of the <code>canvas</code> and start the rows from there. The following diagram shows where the rows will the thus start. You could say this is thinking outside the box &ndash; pun intended.</p><p><img src=/img/blog/morellet/grid_trick.png alt=grid_trick></p><p>Implementing this is a bit trickier than the rest of the code but it&rsquo;s not too difficult. In the following piece of code there are two counters <code>i</code> and <code>j</code> which represent the color of the there respective &ldquo;line&rdquo;. The idea is that there two lines in the previous diagram, the left one starting in red and the right one starting in purple. We can move from the left line to the right one by moving <code>x</code> 2 squares forward. Likewise we can move the right line to the left by moving back by a stretch of 3 squares. At every step the <code>y</code> moves down by one square &ndash; that is, we have to add <code>squareLength</code> to it because the origin is at the top-left of the canvas.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>var</span> <span class=nx>x</span> <span class=o>=</span> <span class=mf>1.5</span> <span class=o>*</span> <span class=nx>squareLength</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>y</span> <span class=o>=</span> <span class=o>-</span><span class=mf>0.5</span> <span class=o>*</span> <span class=nx>squareLength</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>j</span> <span class=o>=</span> <span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>rc</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>colors</span> <span class=o>=</span> <span class=p>[</span><span class=nx>purple</span><span class=p>,</span> <span class=nx>blue</span><span class=p>,</span> <span class=nx>green</span><span class=p>,</span> <span class=nx>yellow</span><span class=p>,</span> <span class=nx>orange</span><span class=p>,</span> <span class=nx>red</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>mirror</span> <span class=o>=</span> <span class=p>[</span><span class=nx>yellow</span><span class=p>,</span> <span class=nx>orange</span><span class=p>,</span> <span class=nx>red</span><span class=p>,</span> <span class=nx>purple</span><span class=p>,</span> <span class=nx>blue</span><span class=p>,</span> <span class=nx>green</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=p>(</span><span class=kc>true</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// rc % 2 tells use which line we&#39;re on
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>if</span> <span class=p>(</span><span class=nx>rc</span> <span class=o>%</span> <span class=mi>2</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>idx</span> <span class=o>=</span> <span class=nx>i</span>
</span></span><span class=line><span class=cl>    <span class=nx>i</span> <span class=o>=</span> <span class=p>(</span><span class=nx>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>%</span> <span class=mi>6</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>idx</span> <span class=o>=</span> <span class=nx>j</span>
</span></span><span class=line><span class=cl>    <span class=nx>j</span> <span class=o>=</span> <span class=p>(</span><span class=nx>j</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>%</span> <span class=mi>6</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=kd>var</span> <span class=nx>color1</span> <span class=o>=</span> <span class=nx>colors</span><span class=p>[</span><span class=nx>idx</span><span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=kd>var</span> <span class=nx>color2</span> <span class=o>=</span> <span class=nx>mirror</span><span class=p>[</span><span class=nx>idx</span><span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=nx>drawRow</span><span class=p>(</span><span class=k>new</span> <span class=nx>Point</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span> <span class=nx>y</span><span class=p>),</span> <span class=nx>squareLength</span><span class=p>,</span> <span class=nx>color1</span><span class=p>,</span> <span class=nx>color2</span><span class=p>,</span> <span class=nx>ctx</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=c1>// Stop if we&#39;ve gone past the bottom of the canvas
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>if</span> <span class=p>(</span><span class=nx>y</span> <span class=o>&gt;</span> <span class=mi>800</span><span class=p>)</span> <span class=p>{</span> <span class=k>break</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=c1>// Update the first cross coordinates and the row counter
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>if</span> <span class=p>(</span><span class=nx>rc</span> <span class=o>%</span> <span class=mi>2</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>x</span> <span class=o>=</span> <span class=nx>x</span> <span class=o>-</span> <span class=mi>3</span> <span class=o>*</span> <span class=nx>squareLength</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>x</span> <span class=o>=</span> <span class=nx>x</span> <span class=o>+</span> <span class=mi>2</span> <span class=o>*</span> <span class=nx>squareLength</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=nx>y</span> <span class=o>=</span> <span class=nx>y</span> <span class=o>+</span> <span class=mi>1</span> <span class=o>*</span> <span class=nx>squareLength</span>
</span></span><span class=line><span class=cl>  <span class=nx>rc</span> <span class=o>=</span> <span class=nx>rc</span> <span class=o>+</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Doing this gives exactly the targeted result.</p><p><img src=/img/blog/morellet/result.png alt=result></p><p>For fun you can change the colors and the size of the squared. In the following image I used a set of 6 pastel colors and set <code>length</code> as <code>canvasWidth / nSquares / 8</code>.</p><p><img src=/img/blog/morellet/pastel.png alt=pastel></p><p>Finally the following images uses the original colors but with a <code>length</code> set to <code>canvasWidth / nSquares / 16</code>.</p><p><img src=/img/blog/morellet/small.png alt=small></p><p>That&rsquo;s all for now! I hope you enjoyed it. I think it turned to be a tad more complex that I thought it would be, but it&rsquo;s still nothing really difficult. As per usual the hardest part is translating a thought process to code in a manner that is as terse and as elegant as possible. You can the full code along with the rest of my works on <a href=https://github.com/MaxHalford/procedural-art>GitHub</a>.</p></div><script type=text/javascript>var s=document.createElement("script");s.setAttribute("src","https://utteranc.es/client.js"),s.setAttribute("repo","MaxHalford/maxhalford.github.io"),s.setAttribute("issue-term","pathname"),s.setAttribute("crossorigin","anonymous"),s.setAttribute("async",null),s.setAttribute("theme","github-light"),document.body.appendChild(s)</script><div class=footer><div class=do-the-thing><div class=elevator><svg class="sweet-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 100 100" enable-background="new 0 0 100 100" height="100" width="100"><path d="M70 47.5H30c-1.4.0-2.5 1.1-2.5 2.5v40c0 1.4 1.1 2.5 2.5 2.5h40c1.4.0 2.5-1.1 2.5-2.5V50C72.5 48.6 71.4 47.5 70 47.5zm-22.5 40h-5v-25h5v25zm10 0h-5v-25h5v25zm10 0h-5V60c0-1.4-1.1-2.5-2.5-2.5H40c-1.4.0-2.5 1.1-2.5 2.5v27.5h-5v-35h35v35z"/><path d="M50 42.5c1.4.0 2.5-1.1 2.5-2.5V16l5.7 5.7c.5.5 1.1.7 1.8.7s1.3-.2 1.8-.7c1-1 1-2.6.0-3.5l-10-10c-1-1-2.6-1-3.5.0l-10 10c-1 1-1 2.6.0 3.5 1 1 2.6 1 3.5.0l5.7-5.7v24c0 1.4 1.1 2.5 2.5 2.5z"/></svg>Back to the top</div></div></div><script src=https://cdnjs.cloudflare.com/ajax/libs/elevator.js/1.0.1/elevator.min.js></script>
<script>var elementButton=document.querySelector(".elevator"),elevator=new Elevator({element:elementButton,mainAudio:"/music/elevator.mp3",endAudio:"/music/ding.mp3"})</script><style>.down-arrow{font-size:120px;margin-top:90px;margin-bottom:90px;text-shadow:0 -20px #0c1f31,0 0 #c33329;color:transparent;-webkit-transform:scaleY(.8);-moz-transform:scaleY(.8);transform:scaleY(.8)}.elevator{text-align:center;cursor:pointer;width:140px;margin:auto;margin-bottom:30px}.elevator:hover{opacity:.7}.elevator svg{width:40px;height:40px;display:block;margin:auto;margin-bottom:5px}</style><div class=related-content><h3 style=margin-top:10px!important;margin-bottom:10px!important>Related posts</h3><ul style=margin-top:0><li><a href=/blog/recursive-polygons/>Recursive polygons with JavaScript</a></li><li><a href=/blog/unknown-pleasures/>Unknown pleasures with JavaScript</a></li><li><a href=/blog/stella-triangles/>Stella triangles with JavaScript</a></li></ul></div></div></div></article><script></script></body></html>